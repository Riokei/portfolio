<!doctype html><html lang=en-us class=h-100><head><title>Devlog: Email Blaster</title><meta charset=utf-8><meta name=description content="Chris W.'s web developer portfolio."><meta name=dc.relation content="http://riokei.github.io"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script src=https://kit.fontawesome.com/cda496ef33.js crossorigin=anonymous></script>
<link rel=stylesheet type=text/css href=/bootstrap/css/bootstrap.min.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/devicons/devicon@v2.14.0/devicon.min.css><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⌨️</text></svg>"></head><body class="d-flex flex-column h-100"><header><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><div class=container-fluid><a class=navbar-brand href=http://riokei.github.io>Chris W.</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarCollapse><ul class="navbar-nav me-auto mb-2 mb-md-0"><li class=nav-item><a class=nav-link href=http://riokei.github.io>Home</a></li><li class=nav-item><a class=nav-link aria-current=page href=/blog/ title="blog section">Blog</a></li></ul></ul></div></div></nav></header><div id=content class=container-fluid><section id=main class="pt-5 my-5"><div class=container><article class="card rounded-0 shadow-none"><div class=card-body><div class="d-flex justify-content-between"><h2 id=title class=text-dark>Devlog: Email Blaster</h2><div><a href=http://riokei.github.io/blog class="btn btn-outline-dark">&lt;-- Back to Index</a></div></div><div class="d-flex justify-content-start"><h5 id=date>Wed Apr 26, 2023 | 1229 Words</h5></div><div class=row><div class=col-12><article id="content text-dark"><h1 id=what-is-email-blaster>What is Email Blaster?</h1><p>Email Blaster is a project I wrote as part of the &ldquo;The Complete .NET Coding Bootcamp Course&rdquo; from Coder Foundry. In this blog post I&rsquo;ll talk about the project I made, tweaks I added to it, and show it off here. The project is written in C# using .NET MVC, PostgreSQL, Microsoft Identity, Entity Framework Core, Mailkit, and MimeKit.</p><p>To start, here is what the homepage of the project looks like:<div class="text-center pb-3"><img src=Screenshot_1.png alt=Homepage decoding=async class=img-fluid></div></p><p>You can see the style Microsoft Identity login pages on the top right, a logo and nav link on the left, a hero in the center, and a footer at the bottom. This layout is slightly different than the rest of the side due to how the bootstrap container is set up and the custom class for the hero is used.</p><p>Moving on here is the styled default Identity log in:<div class="text-center pb-3"><img src=Screenshot_2.png alt="Log in page" decoding=async class=img-fluid></div></p><p>Upon logging in you&rsquo;ll be taken back to the home page but you&rsquo;ll now see a new navigation up top.<div class="text-center pb-3"><img src=login.png alt="screenshot of logged in navigation showing new pages" decoding=async class=img-fluid></div>As you can see the new things here are Contacts, Categories, and a &ldquo;Hello email@email !&rdquo; and Log out button. I blocked out the email on this but it does show properly in the live application. Now before I show screenshots of the Contacts and Categories pages let me first explain the set up of the models a bit.</p><h2 id=contacts-model>Contacts Model</h2><p>Each user has their own set of Contacts, contacts are defined by an Id, AppUserId, FirstName, LastName, a not mapped FullName, Birthdate, Address1 (line 1), Address 2 (line 2 if needed but only line 1 is required), City, State, ZipCode (using DataType.PostalCode), Email, PhoneNumber, Created, and lastly the image fields ImageData, ImageType, a not mapped IFormFile ImageFile, and lastly some virtuals to reference AppUser and Categories for use with lambda expressions via Entity Framework later.</p><h2 id=categories-model>Categories Model</h2><p>Likewise, each user has their own set of Categories that have an Id, AppUserID, Name, and the two virtuals but this time Categories references Contacts.</p><hr><p>Now on to the Contacts page:<div class="text-center pb-3"><img src=Screenshot_4.png alt="View of the contacts page." decoding=async class=img-fluid></div></p><p>Starting off I&rsquo;d like to talk about the search bar, category filter drop-down, and state filter drop-down. In the course, we created the search bar and category filter by filtering what contacts are returned to the view by either the search or list of categories applied to different contacts. Adding on to this I added a feature to filter by state, since States are in an enum list I created a variable &ldquo;stateResult&rdquo; using:</p><pre tabindex=0><code>var contact = from s in _context.Contacts select s;
var stateResult = from States s in Enum.GetValues(typeof(States)) select new { Id = s.ToString(), Name = s.ToString() };
ViewData[&#34;States&#34;] = new SelectList(stateResult, &#34;Id&#34;, &#34;Name&#34;,  state);
</code></pre><p>to put those fields into the view and then as I&rsquo;d already written out the if else statement for filtering by category I added an else if for filtering by state:</p><pre tabindex=0><code>if (appUser != null)
            {
                if (catId == 0 &amp;&amp; state == null || state == &#34;All Contacts&#34;)
                {
                    contacts = appUser.Contacts.OrderBy(c =&gt; c.FullName).ToList();
                }
                
                else if (catId != 0)
                {
                    contacts = appUser.Categories.FirstOrDefault(c =&gt; c.Id == catId)!
                        .Contacts
                        .OrderBy(c =&gt; c.FirstName)
                        .ThenBy(c =&gt; c.LastName)
                        .ToList();
                }
                //Add in the state filter.
                else if (state != null)
                {
                    contacts = contact.Where(c =&gt; c.State == (States)Enum.Parse(typeof(States), state))
                        .OrderBy(c =&gt; c.FirstName)
                        .ThenBy(c =&gt; c.LastName)
                        .ToList();

                }
            }
</code></pre><p>This allows for filtering the contacts before returning them to the view so users can filter by an email contacts&rsquo; state.</p><h2 id=now-lets-look-at-the-crud-pages-for-this>Now let&rsquo;s look at the CRUD pages for this:</h2><h3 id=create-and-edit>Create and Edit</h3><p><div class="text-center pb-3"><img src=Screenshot_8.png alt="View of the edit page." decoding=async class=img-fluid></div>This page is basically the same on both create and update/edit minus there being a default image on the create that changes upon upload. Here you can select categories but you can&rsquo;t create categories until you go to the categories page, I&rsquo;ll show that later in this post.</p><h3 id=delete>Delete</h3><p><div class="text-center pb-3"><img src=Screenshot_10.png alt="View of the delete page." decoding=async class=img-fluid></div>A borderline default EF Core generated delete page with just a bit of styling and a few fields deleted.</p><h3 id=where-is-the-read-page>Where is the read page?</h3><p>As you can see all the information on the index page the view for looking at individual contacts was removed.</p><h3 id=the-last-page-for-contacts-email-contact>The last page for contacts &ldquo;Email Contact&rdquo;</h3><p><div class="text-center pb-3"><img src=Screenshot_19.png alt="Screenshot of a contact with a red box around an email icon." decoding=async class=img-fluid></div>You might have noticed the highlighted email icon, this upon clicking will take you to the main feature of Email Blaster, the email contact page.<div class="text-center pb-3"><img src=Screenshot_9.png alt="Screenshot of the email contact page" decoding=async class=img-fluid></div>I&rsquo;ve blurred out my email used for testing but as you can see the email contact form will be pre-filled with the email of the contact you clicked the icon on, you can then fill out a subject and message and click send to send an email right from the application. Upon success you&rsquo;ll be taken back to the main view and an animation will play ending with &ldquo;Sucess! Email sent!&rdquo;<div class="text-center pb-3"><img src=Screenshot_18.png alt="Screenshot of the email contact page" decoding=async class=img-fluid></div>This is courtesy of <a href=https://sweetalert2.github.io/>Sweet Alert 2</a>.
The set up for the email feature consists of a model called EmailData that contains all the information for the email like subject, body, email address, but also an id for each email, first and last name, and the GroupName which comes from the category filter. In this particular instance, you can&rsquo;t see the group name being used but later in the section about the category page, you&rsquo;ll see it.</p><h2 id=moving-on-to-the-category-crud-pages>Moving on to the Category CRUD pages:</h2><p>First, lets start with the index of categories:<div class="text-center pb-3"><img src=Screenshot_11.png alt="Screenshot of category index view." decoding=async class=img-fluid></div>It is very toned down compared to the contacts page having only the categories themselves and their edit, email, and delete buttons.</p><h3 id=createedit>Create/Edit</h3><p><div class="text-center pb-3"><img src=Screenshot_12.png alt="Screenshot of category create view." decoding=async class=img-fluid></div>As you can see here just like with the index the create/edit page is also very basic. Categories created here can be selected on the contacts page</p><h3 id=delete-1>Delete</h3><p><div class="text-center pb-3"><img src=Screenshot_15.png alt="Screenshot of category delete view." decoding=async class=img-fluid></div>Just like the delete for the Contacts section, you can delete categories as well.</p><h3 id=email-category>Email Category</h3><p><div class="text-center pb-3"><img src=Screenshot_14.png alt="Screenshot of category delete view." decoding=async class=img-fluid></div>Here you can finally see the ability to email an entire category which will automatically input all contacts in a category separating their emails like so <code>"email@email.com,email2@email.com"</code> and so on. This allows you to email multiple contacts at once.</p><h2 id=now-lets-talk-about-how-categories-work>Now let&rsquo;s talk about how categories work.</h2><p>Categories work via a Service that does the heavy lifting to connect Categories to Contacts, this service is implemented via AddressBookService and IAddressBookService. It is called multiple times in the Contacts controller to for example check if a contact is in a category, remove a contact from a category, add a contact, get the user&rsquo;s list of categories, and feed a list of categories to the select menu in the Contact create/edit pages, etc.</p><p>This is not the only service implemented to do a lot of heavy lifting either. There is an image service that handles the conversion of uploaded images, and the email service.</p><h2 id=email-service>Email Service</h2><p>The email service, combined with Mailkit and MimeKit allows the sending of emails. Its mail settings are set, a new email is created, it parses through each email address making sure to add a &ldquo;,&rdquo; between each one if there are multiple, sets the subject and body, and finally using Mailkit&rsquo;s SmtpClient connects and sends the email.</p><h2 id=finishing-up>Finishing up:</h2><p>The last steps for this project were adding custom error pages, styling the website to be more unique (i.e. not the default template, and adding a custom hero image). Overall a very interesting and fun project I learned a lot from and hope to make more projects with the things I learned in the future. (I have started a simple inventory manager based on this but it&rsquo;s not quite done yet.)</p><p>Thank you for your time in reading this log.</p></article></div><div class=col-2></div></div><div class="d-flex justify-content-between py-5"><div><a href=http://riokei.github.io/blog class="btn btn-dark rounded-0">&lt;-- Back to Index</a></div><div><h4>Tags</h4><a href=http://riokei.github.io/tags/devlog/ class="badge btn-dark rounded-0">devlog</a>
<a href=http://riokei.github.io/tags/.net/ class="badge btn-dark rounded-0">.net</a>
<a href=http://riokei.github.io/tags/mvc/ class="badge btn-dark rounded-0">mvc</a>
<a href=http://riokei.github.io/tags/c#/ class="badge btn-dark rounded-0">c#</a></div></div></div></article></section></div><footer class="footer mt-auto py-3 bg-dark"><div class="container text-center"><div class="row gy-2"><div class="col text-white d-flex align-items-center justify-content-center"><div class=row><div class="col social"><a href=https://github.com/Riokei target=_blank alt="Link to Github Profile"><i class="fab fa-github text-white fa-2x"></i></a></div></div></div></div><div class=row><div class=col-12><p class=text-muted>© 2022, generated via Hugo, designed by <a href=https://github.com/Riokei>Chris W.</a><br>Image by <a href=https://unsplash.com/photos/nPhl2x4fk2s>@clark_fransa</a>.</p></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p crossorigin=anonymous></script></body></html>